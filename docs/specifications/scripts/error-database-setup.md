# Notionエラーデータベース設定ガイド

## 概要
ターミナルエラーをNotionに同期するためのデータベース構造を設定します。

## 1. エラーデータベースの作成

### 1.1 新しいデータベースを作成
1. Notionで新しいページを作成
2. `/database` と入力して「Table - Full page」を選択
3. データベース名を「エラー管理」に設定

### 1.2 プロパティの設定

以下のプロパティを追加してください：

| プロパティ名 | タイプ | オプション | 説明 |
|-------------|--------|------------|------|
| タイトル | Title | - | エラーのタイトル（自動生成） |
| エラータイプ | Select | Python Error<br>Python File Error<br>General Error<br>HTTP Error<br>Import Error<br>Permission Error<br>Connection Error | エラーの種類 |
| ステータス | Select | 未対応<br>調査中<br>対応中<br>完了<br>無視 | 対応状況 |
| 発生日時 | Date | - | エラーが発生した日時 |
| 監視タイプ | Select | 手動<br>リアルタイム<br>バッチ | エラー検出方法 |
| 優先度 | Select | 低<br>中<br>高<br>緊急 | エラーの重要度 |
| 担当者 | Person | - | 対応担当者 |
| プロジェクト | Select | Whisper Transcribe<br>その他 | 関連プロジェクト |
| エラーメッセージ | Text | - | エラーメッセージの要約 |
| ファイルパス | Text | - | エラーが発生したファイル |
| 行番号 | Number | - | エラーが発生した行番号 |

## 2. ビューの設定

### 2.1 デフォルトビュー
- **名前**: 全てのエラー
- **フィルター**: なし
- **ソート**: 発生日時（降順）

### 2.2 ステータス別ビュー
- **名前**: 未対応エラー
- **フィルター**: ステータス = 未対応
- **ソート**: 発生日時（降順）

### 2.3 優先度別ビュー
- **名前**: 緊急エラー
- **フィルター**: 優先度 = 緊急
- **ソート**: 発生日時（降順）

### 2.4 プロジェクト別ビュー
- **名前**: Whisper関連エラー
- **フィルター**: プロジェクト = Whisper Transcribe
- **ソート**: 発生日時（降順）

## 3. テンプレートの作成

### 3.1 エラー詳細テンプレート
新しいページを作成し、以下の内容を追加：

```markdown
# エラー詳細

## 基本情報
- **エラータイプ**: 
- **発生日時**: 
- **ステータス**: 
- **優先度**: 
- **担当者**: 

## エラー内容
- **エラーメッセージ**: 
- **ファイル**: 
- **行番号**: 
- **実行コマンド**: 

## 調査・対応
### 原因分析
- 

### 対応策
- 

### 再発防止策
- 

## 履歴
- YYYY-MM-DD: エラー発生
- YYYY-MM-DD: 調査開始
- YYYY-MM-DD: 対応完了
```

### 3.2 テンプレートの設定
1. エラーデータベースで「+ New」をクリック
2. 「Templates」から「エラー詳細」を選択
3. テンプレートとして保存

## 4. 自動化の設定

### 4.1 通知設定
1. データベースの「...」メニューをクリック
2. 「Notifications」を選択
3. 以下の条件で通知を設定：
   - 新しいエラーが追加された時
   - ステータスが変更された時
   - 優先度が「緊急」のエラーが追加された時

### 4.2 自動タグ付け
1. データベースの「...」メニューをクリック
2. 「Automation」を選択
3. 以下のルールを設定：
   - エラータイプが「Python Error」の場合、プロジェクトを「Whisper Transcribe」に設定
   - エラータイプが「HTTP Error」の場合、優先度を「中」に設定
   - エラータイプが「Import Error」の場合、優先度を「高」に設定

## 5. 環境変数の設定

### 5.1 エラーデータベースIDの取得
1. エラーデータベースページのURLをコピー
2. URLからデータベースIDを抽出
   - 例: `https://notion.so/workspace/1234567890abcdef` → `1234567890abcdef`

### 5.2 環境変数の設定
```bash
# .envファイルに追加
echo "NOTION_ERROR_DB_ID=your_error_database_id_here" >> .env

# または環境変数として設定
export NOTION_ERROR_DB_ID="your_error_database_id_here"
```

## 6. 使用方法

### 6.1 手動エラー同期
```bash
# コマンドを実行してエラーを同期
python docs/specifications/scripts/error-log-sync.py "python app/main.py"
```

### 6.2 リアルタイム監視
```bash
# リアルタイムでエラーを監視
python docs/specifications/scripts/realtime-error-monitor.py "python app/main.py"
```

### 6.3 既存ログファイルの同期
```bash
# ログファイルからエラーを抽出して同期
python docs/specifications/scripts/error-log-sync.py "cat app.log"
```

## 7. カスタマイズ

### 7.1 エラーパターンの追加
`realtime-error-monitor.py`の`_load_error_patterns`メソッドを編集して、新しいエラーパターンを追加できます。

### 7.2 通知設定のカスタマイズ
Notionの通知設定で、特定の条件に基づいてSlackやメールに通知を送信できます。

### 7.3 レポート生成
データベースの内容をエクスポートして、定期的なエラー分析レポートを生成できます。

## 更新履歴
- 2024-01-XX: 初版作成 